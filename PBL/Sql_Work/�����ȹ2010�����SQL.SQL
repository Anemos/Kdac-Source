SELECT A.XPLANT, A.DIV, A.ITNO, A.CLS, A.SRCE
FROM PBINV.INV101 A INNER JOIN (
SELECT COMLTD, BALCD, BALDIV, BMDNO, BPRNO, COUNT(*) FROM PBBPM.BPM508
WHERE BWOCT = '8888'
GROUP BY COMLTD, BALCD, BALDIV, BMDNO, BPRNO
HAVING COUNT(*) > 0) B
	ON A.COMLTD = B.COMLTD AND A.XPLANT = B.BALCD AND
		A.DIV = B.BALDIV AND A.ITNO = B.BPRNO;
		

//SELECT DISTINCT TMP.XYEAR, TMP.BREV, TMP.BALCD, TMP.BALDIV, TMP.BPRNO
//FROM (
//SELECT XYEAR, BREV, BALCD, BALDIV, BPRNO, COUNT(*) FROM PBBPM.BPM508
//		WHERE BWOCT = '8888' AND XYEAR = '2010' AND BREV = 'A9' AND BGUBUN = 'A'
//		GROUP BY XYEAR, BREV, BALCD, BALDIV, BMDNO, BPRNO
//		HAVING COUNT(*) > 0 ) TMP
//ORDER BY TMP.XYEAR, TMP.BREV, TMP.BALCD, TMP.BALDIV, TMP.BPRNO;

//SELECT DISTINCT XYEAR,BREV,BALCD,BALDIV,BCHNO FROM PBBPM.BPM508
//WHERE COMLTD = '01' AND XYEAR = '2010 'AND BREV = 'A9' AND
//BGUBUN = 'A' AND BYGCHK = 'Y'
//ORDER BY XYEAR,BREV,BALCD,BALDIV,BCHNO;

SELECT * FROM PBPDM.BOM001
WHERE PPITN = '835507Z';

//SELECT * FROM PBBPM.BPM508
//WHERE XYEAR = '2010' AND BREV = 'A9' AND BGUBUN = 'A' AND BMDNO = '835507Z';

//SELECT * FROM PBINV.INV101
//WHERE COMLTD = '01' AND ITNO = '835507Z';

//SELECT * FROM PBPDM.BOM003
//WHERE OFITN = '835507Z';

SELECT COMLTD,XYEAR,BREV,BGUBUN,BPLANT,BDIV,BMDCD,BMDNO,BSERNO,BCHNO
FROM PBBPM.BPM508
WHERE COMLTD = '01' AND XYEAR = '2010' AND BREV = 'A9' AND
BYGCHK = 'Y' AND BGUBUN = 'A' 
ORDER BY BPLANT,BDIV,BMDNO,BLEV DESC;

-- 이체품목가져오기
SELECT A.BPLANT,A.BDIV,A.BMDNO,A.BALCD,A.BALDIV,A.BCHNO,A.BPRQT1,B.CLS,B.SRCE
FROM PBBPM.BPM508 A INNER JOIN PBBPM.BPM503 B
	ON A.XYEAR = B.XYEAR AND A.BREV = B.REVNO AND
		A.BPLANT = B.XPLANT AND A.BDIV = B.DIV AND
    A.BCHNO = B.ITNO
WHERE A.COMLTD = '01' AND A.XYEAR = '2011' AND A.BREV = '0A' AND
A.BGUBUN = 'B' AND A.BPLANT = 'B' AND A.BDIV = 'A' AND A.BMDNO = '25183479';