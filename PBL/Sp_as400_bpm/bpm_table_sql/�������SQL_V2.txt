//SELECT * FROM PBBPM.BPM106
//WHERE COMLTD = '01' AND AYEAR = '2009' AND ACODE = 'A' AND APLANT = 'D' AND ADIV = 'A' 
//ORDER BY AMDNO, ADECD
//;

SELECT * FROM PBBPM.BPM107
WHERE COMLTD = '01' AND MYEAR = '2009' AND MPLANT = 'D' AND MDIV = 'A' AND MMDNO = '17201253';

//SELECT * FROM PBINV.INV101
//WHERE COMLTD = '01' AND ITNO = '17201253';


//SELECT * FROM PBBPM.BPM107
//WHERE COMLTD = '01' AND MYEAR = '2009' AND MPLANT = 'D' AND MDIV = 'A' AND MMDNO = '17201253';

-- 단가혁신처리 SQL문
SELECT TMP.COMLTD,'2010',TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD,0,
-- COSTDOWN 처리


FROM ( SELECT DISTINCT COMLTD,AYEAR,APLANT,ADIV,APDCD,AMDNO,'E' AS ADECD,SEQGB FROM PBBPM.BPM106
WHERE COMLTD = '01' AND AYEAR = '2009' AND APLANT = 'D' AND ADIV = 'A' AND ACODE = 'A'
UNION ALL
SELECT DISTINCT COMLTD,AYEAR,APLANT,ADIV,APDCD,AMDNO,'D' AS ADECD,SEQGB FROM PBBPM.BPM106
WHERE COMLTD = '01' AND AYEAR = '2009' AND APLANT = 'D' AND ADIV = 'A' AND ACODE = 'A') AA
INNER JOIN PBBPM.BPM413 TMP
ON AA.COMLTD = TMP.COMLTD AND AA.APLANT = TMP.BPLANT AND AA.ADIV = TMP.BDIV AND
	AA.AMDNO = TMP.BMDNO AND AA.AYEAR = TMP.AYEAR
LEFT OUTER JOIN PBBPM.BPM103 BB
ON  BB.COMLTD = TMP.COMLTD AND BB.YCCYY = TMP.AYEAR AND
  BB.YPLANT = TMP.BPLANT AND BB.YDIV = TMP.BDIV AND 
  BB.YVNDSR = TMP.YVNDSR AND BB.BCHNO = TMP.YITNO AND YGRAD = '1'
GROUP BY TMP.COMLTD,TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD
ORDER BY TMP.COMLTD,TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD;
