SELECT TMP.COMLTD,'2010',TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD,0,
-- 내자 금액계산 
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '10' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDWON,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '11' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDUSD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '12' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDJPY,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '13' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDDEM,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '14' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDFRF,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '15' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDGBP,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '16' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDAUD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '17' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDESP,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '18' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDEUR,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '19' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDITL,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '20' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDCHF,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '21' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDBFR,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '22' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDDKK,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '23' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDATS,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '24' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDCAD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '25' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDSEK,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '26' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDRMB,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '27' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDFIM,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE <> '01' AND TMP.CLS <> '50' THEN
			CASE WHEN TMP.CURD_NO = '99' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MDETC,
--외자재료비 계산
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '11' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIUSD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '12' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIJPY,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '13' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIDEM,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '14' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIFRF,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '15' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIGBP,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '16' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIAUD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '17' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIESP,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '18' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIEUR,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '19' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIITL,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '20' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MICHF,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '21' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIBFR,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '22' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIDKK,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '23' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIATS,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '24' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MICAD,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '25' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MISEK,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '26' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIRMB,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '27' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIFIM,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.SRCE = '01' THEN
			CASE WHEN TMP.CURE_NO = '99' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MIETC,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.CLS = '40' THEN
			CASE WHEN TMP.CURD_NO = '10' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MOMAT,
SUM( DECIMAL(CASE WHEN TMP.BWOCT <> '8888' AND TMP.BYOU <> '*' AND TMP.CLS = '50' THEN
			CASE WHEN TMP.CURD_NO = '10' THEN 
				CASE WHEN AA.ADECD = 'D' THEN TMP.CURDCST * TMP.WKEXCD / TMP.CONV_FACTOR * TMP.BPRQT
 				ELSE TMP.CURECST * TMP.WKEXCE / TMP.CONV_FACTOR * TMP.BPRQT END
			ELSE 0 END
		ELSE 0 END,15,6) ) AS MOLAT
FROM ( SELECT DISTINCT COMLTD,AYEAR,APLANT,ADIV,APDCD,AMDNO,'E' AS ADECD,SEQGB FROM PBBPM.BPM106
WHERE COMLTD = '01' AND AYEAR = '2009' AND APLANT = 'D' AND ADIV = 'A' AND ACODE = 'A'
UNION ALL
SELECT DISTINCT COMLTD,AYEAR,APLANT,ADIV,APDCD,AMDNO,'D' AS ADECD,SEQGB FROM PBBPM.BPM106
WHERE COMLTD = '01' AND AYEAR = '2009' AND APLANT = 'D' AND ADIV = 'A' AND ACODE = 'A') AA
INNER JOIN PBBPM.BPM413 TMP
ON AA.COMLTD = TMP.COMLTD AND AA.APLANT = TMP.BPLANT AND AA.ADIV = TMP.BDIV AND
	AA.AMDNO = TMP.BMDNO AND AA.AYEAR = TMP.AYEAR
GROUP BY TMP.COMLTD,TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD
ORDER BY TMP.COMLTD,TMP.APLANT,TMP.ADIV,TMP.APDCD,TMP.AMDNO,AA.SEQGB,AA.ADECD;